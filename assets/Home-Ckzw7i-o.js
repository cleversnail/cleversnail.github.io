import{a as L}from"./index-C9nhHDE0.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as c,o as A,f as w,b as p,h as I,w as k,d as t,n as D,c as $,F as C,i as R,j as r,e as f,k as V,l as H,u as M,g as E,r as O}from"./index-DG5awykm.js";import{P as S}from"./PopAdd-B0NzTewT.js";import{f as G,a as J}from"./date-DzHNuEYm.js";const K={class:"pop"},Q={class:"content"},W={class:"list"},X={class:"exponse-wrap item"},Y=["onClick"],Z={class:"list"},ee={class:"income-wrap item"},te=["onClick"],se={__name:"PopType",emits:["handleType"],setup(x,{expose:v,emit:y}){const n=c(!1),_=c([]),d=c([]);A(async()=>{const i=await L.get("/api/type/list");_.value=i.data.list.filter(e=>e.type==="1"),d.value=i.data.list.filter(e=>e.type==="2")});const a=c("all"),s=y,l=i=>{a.value=i.id,n.value=!1,s("handleType",i)};return v({show:n}),(i,e)=>{const u=w("van-popup");return p(),I(u,{show:n.value,"onUpdate:show":e[1]||(e[1]=o=>n.value=o),position:"bottom",round:"",closeable:""},{default:k(()=>[t("div",K,[t("div",Q,[t("div",{class:D(["all",{active:a.value==="all"}]),onClick:e[0]||(e[0]=o=>l({id:"all"}))},"全部类型",2),t("div",W,[e[2]||(e[2]=t("div",{class:"title"},"支出",-1)),t("div",X,[(p(!0),$(C,null,R(_.value,o=>(p(),$("p",{class:D({active:a.value===o.id}),key:o.id,onClick:b=>l(o)},r(o.name),11,Y))),128))])]),t("div",Z,[e[3]||(e[3]=t("div",{class:"title"},"收入",-1)),t("div",ee,[(p(!0),$(C,null,R(d.value,o=>(p(),$("p",{class:D({active:a.value===o.id}),key:o.id,onClick:b=>l(o)},r(o.name),11,te))),128))])])])])]),_:1},8,["show"])}}},ae=B(se,[["__scopeId","data-v-bdb461c3"]]),le={__name:"PopTime",emits:["handleTime"],setup(x,{expose:v,emit:y}){const n=c(!1),_=["year","month"],d=new Date(2020,0),a=new Date,s=c([new Date]),l=y,i=({selectedValues:e,selectedOptions:u,selectedIndexes:o})=>{l("handleTime",e),n.value=!1};return v({show:n}),(e,u)=>{const o=w("van-date-picker"),b=w("van-popup");return p(),I(b,{show:n.value,"onUpdate:show":u[2]||(u[2]=g=>n.value=g),position:"bottom",round:""},{default:k(()=>[f(o,{modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=g=>s.value=g),title:"选择年月","min-date":V(d),"max-date":V(a),onCancel:u[1]||(u[1]=()=>n.value=!1),"columns-type":_,onConfirm:i},null,8,["modelValue","min-date","max-date"])]),_:1},8,["show"])}}},oe={class:"head"},ne={class:"date"},ie={class:"money"},ce={__name:"CardItem",props:{billItem:{type:Object,default:()=>({})}},setup(x){const v=x,y=H(()=>{let a=0;return v.billItem.bills.forEach(s=>{s.pay_type===1&&(a+=+s.amount)}),a.toFixed(2)}),n=H(()=>{let a=0;return v.billItem.bills.forEach(s=>{s.pay_type===2&&(a+=+s.amount)}),a.toFixed(2)}),_=M(),d=a=>{_.push({path:"/detail",query:{id:a.id}})};return(a,s)=>{const l=w("van-cell"),i=w("van-cell-group");return p(),I(i,null,{default:k(()=>[t("div",oe,[t("div",ne,r(x.billItem.date.split("-")[1])+"月"+r(x.billItem.date.split("-")[2])+"日",1),t("div",ie,[t("span",null,[s[0]||(s[0]=t("i",null,"出",-1)),E(r(y.value),1)]),t("span",null,[s[1]||(s[1]=t("i",null,"入",-1)),E(r(n.value),1)])])]),(p(!0),$(C,null,R(x.billItem.bills,e=>(p(),I(l,{key:e.id,title:e.type_name,value:`${e.pay_type===1?"-":"+"}${e.amount}`,label:`${V(G)(+e.date)} ${e.remark}`,"value-class":`${e.pay_type===1?"expense":"cart-income"}`,onClick:u=>d(e)},{icon:k(()=>[t("div",{class:D(["icon",{income:e.pay_type===2}])},s[2]||(s[2]=[t("i",{class:"iconfont icon-shouye"},null,-1)]),2)]),_:2},1032,["title","value","label","value-class","onClick"]))),128))]),_:1})}}},ue=B(ce,[["__scopeId","data-v-5a3b9f6b"]]),pe={class:"home"},de={class:"header"},re={class:"title"},ve={class:"data-wrap"},me={class:"expense"},_e={class:"income"},fe={class:"content"},ye={__name:"Home",setup(x){const v=c({}),y=c(null),n=c(null),_=c(null),d=c(J(new Date).slice(0,-1)),a=c(!1),s=c(!1),l=O({list:[],totalExpense:0,totalIncome:0,totalPage:0}),i=c(!1),e=c(1),u=async()=>{await o(),e.value>l.totalPage&&(i.value=!0),s.value=!1},o=async()=>{const{data:m}=await L.get(`/api/bill/list?date=${d.value.join("-")}&type_id=${v.value.id||"all"}&page=${e.value}&size=5`);console.log(m),l.list=l.list.concat(m.list),l.totalExpense=m.totalExpense,l.totalIncome=m.totalIncome,l.totalPage=m.totalPage,e.value++},b=()=>{e.value=1,l.list=[],a.value=!0,o().then(()=>{a.value=!1})},g=async m=>{d.value=m,e.value=1,l.list=[],await o(),i.value=!1},U=()=>{n.value.show=!0},z=async m=>{v.value=m,e.value=1,l.list=[],await o(),i.value=!1},F=()=>{y.value.show=!0};return(m,h)=>{const P=w("van-icon"),j=w("van-list"),N=w("van-pull-refresh");return p(),$(C,null,[t("div",pe,[t("div",de,[t("div",{class:"type-wrap",onClick:F},[t("span",re,r(v.value.name||"全部类型"),1),f(P,{name:"qr",size:"20"})]),t("div",ve,[t("span",{class:"time",onClick:U},[E(r(d.value[0])+"年"+r(d.value[1])+"月 ",1),f(P,{class:"arrow",name:"play"})]),t("span",me,"总支出¥"+r(l.totalExpense),1),t("span",_e,"总收入¥"+r(l.totalIncome),1)])]),t("div",fe,[f(N,{class:"refresh",modelValue:a.value,"onUpdate:modelValue":h[1]||(h[1]=T=>a.value=T),onRefresh:b},{default:k(()=>[f(j,{class:"list",loading:s.value,"onUpdate:loading":h[0]||(h[0]=T=>s.value=T),finished:i.value,"finished-text":"没有更多了",onLoad:u,offset:"0"},{default:k(()=>[(p(!0),$(C,null,R(l.list,(T,q)=>(p(),I(ue,{class:"card-item",key:q,billItem:T},null,8,["billItem"]))),128))]),_:1},8,["loading","finished"])]),_:1},8,["modelValue"])]),t("div",{class:"save",onClick:h[2]||(h[2]=()=>_.value.show=!0)},[f(P,{name:"records-o",size:"20"}),h[3]||(h[3]=t("span",null,"记一笔",-1))])]),f(ae,{ref_key:"popTypeRef",ref:y,onHandleType:z},null,512),f(le,{ref_key:"popTimeRef",ref:n,onHandleTime:g},null,512),f(S,{ref_key:"popAddRef",ref:_,onRefresh:b},null,512)],64)}}},ke=B(ye,[["__scopeId","data-v-12d59690"]]);export{ke as default};
